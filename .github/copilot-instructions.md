# Copilot instructions for this workspace (Laravel 12 + Breeze + Pest)

-   Tech stack and layout

    -   PHP 8.2, Laravel 12, Breeze auth scaffolding, Pest tests, Vite + TailwindCSS + Alpine, Axios.
    -   MVC layout: routes in `routes/`, controllers in `app/Http/Controllers`, form requests in `app/Http/Requests`, Eloquent models in `app/Models`, Blade views in `resources/views`.
    -   Default DB is SQLite with file at `database/database.sqlite` (see `config/database.php` and `.env.example`). Session/Cache/Queue use the database drivers by default.

-   Critical workflows (use these commands)

    -   First-time setup: `composer setup` (installs PHP deps, creates `.env`, `APP_KEY`, runs migrations, installs Node deps, builds assets).
    -   Dev server (full stack): `composer dev` (serves app, runs DB queue listener, streams logs via Pail, and starts Vite in watch mode).
    -   Tests: `composer test` (clears config cache and runs `php artisan test` / Pest). Feature tests refresh the DB by default (see `tests/Pest.php`).
    -   Asset build only: `npm run build`; dev/watch only: `npm run dev`.

-   Routing and controllers

    -   Public routes in `routes/web.php`; auth routes in `routes/auth.php` generated by Breeze (login/register/password reset/email verify/logout).
    -   Authenticated area example: `Route::get('/dashboard', ...)->middleware(['auth','verified'])->name('dashboard');`.
    -   Profile flow uses `ProfileController` with a `FormRequest` validator (`ProfileUpdateRequest`) and named routes: `profile.edit|update|destroy`.
    -   Pattern: validate with a dedicated `FormRequest`, mutate the authenticated user, then redirect with a flash status, e.g. `return Redirect::route('profile.edit')->with('status','profile-updated');`.

-   Validation pattern

    -   Prefer `FormRequest` classes in `app/Http/Requests` (see `ProfileUpdateRequest`) that:
        -   Define rules including uniqueness with `Rule::unique(User::class)->ignore($this->user()->id)` for self-updates.
        -   Keep controllers thin (accept the typed request and call `$request->validated()`).

-   Views + assets

    -   Blade layout uses `@vite(['resources/css/app.css','resources/js/app.js'])` in `resources/views/layouts/app.blade.php`.
    -   Shared UI lives in `resources/views/components/*` (buttons, inputs, nav, dropdowns). Reuse these components rather than bespoke markup.
    -   Frontend JS entry (`resources/js/app.js`) starts Alpine; `resources/js/bootstrap.js` wires Axios and X-Requested-With.
    -   Tailwind is configured via `tailwind.config.js`; forms plugin enabled via `@tailwindcss/forms`.

-   Jobs, queues, logs

    -   Queue driver is `database` (see `.env.example`); `composer dev` runs `php artisan queue:listen` alongside the app.
    -   Logs are streamed with `php artisan pail` (invoked by `composer dev`) for live developer feedback.

-   Testing conventions (Pest)

    -   Feature tests live in `tests/Feature`; Pest config (`tests/Pest.php`) applies `RefreshDatabase` to Feature tests and binds to `Tests\TestCase`.
    -   Example: `tests/Feature/ProfileTest.php` uses `actingAs($user)` and asserts redirects/DB mutations on `/profile` routes.

-   Adding a new page (typical flow)

    1. Add a route in `routes/web.php` (name it). 2) Create a controller method in `app/Http/Controllers/...`. 3) Add a Blade view under `resources/views/...`. 4) Link it in `resources/views/layouts/navigation.blade.php`. 5) If the page mutates data, add a `FormRequest`.

-   Migrations and seed data

    -   Migrations are under `database/migrations`; a seed user exists in `database/seeders/DatabaseSeeder.php` (`test@example.com` with default password `password`).
    -   For local DB, ensure `database/database.sqlite` exists (created by Composer post-create) and run `php artisan migrate` when adding migrations.

-   Notes for AI changes
    -   Prefer named routes and redirects with `with('status', ...)` to match existing flows.
    -   Keep controllers skinny; push validation to `FormRequest` and view logic to Blade components.
    -   When writing Feature tests, rely on factories (see `database/factories/UserFactory.php`) and Pest style (`test('...', function () { ... });`).
